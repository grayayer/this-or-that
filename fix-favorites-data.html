<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Fix Favorites Data</title>
	<style>
		body {
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
			padding: 20px;
			background-color: #f8f9fa;
			max-width: 800px;
			margin: 0 auto;
		}

		.fix-section {
			background: white;
			padding: 20px;
			margin-bottom: 20px;
			border-radius: 8px;
			border: 1px solid #e9ecef;
		}

		button {
			padding: 10px 20px;
			margin: 5px;
			border: none;
			border-radius: 4px;
			cursor: pointer;
			font-size: 14px;
		}

		.btn-primary {
			background: #0066cc;
			color: white;
		}

		.btn-danger {
			background: #dc3545;
			color: white;
		}

		.btn-success {
			background: #28a745;
			color: white;
		}

		.status {
			padding: 10px;
			border-radius: 4px;
			margin: 10px 0;
		}

		.status.success {
			background: #d4edda;
			color: #155724;
		}

		.status.error {
			background: #f8d7da;
			color: #721c24;
		}

		pre {
			background: #f8f9fa;
			padding: 15px;
			border-radius: 4px;
			overflow-x: auto;
			white-space: pre-wrap;
			max-height: 300px;
			overflow-y: auto;
		}
	</style>
</head>

<body>
	<h1>üîß Fix Favorites Data</h1>
	<p>This tool will help fix any issues with favorites data by clearing old data and testing with fresh data.</p>

	<div class="fix-section">
		<h2>Step 1: Clear Old Data</h2>
		<p>Clear all existing favorites data to start fresh.</p>
		<button class="btn-danger" onclick="clearAllData()">Clear All Favorites Data</button>
		<div id="clear-status"></div>
	</div>

	<div class="fix-section">
		<h2>Step 2: Test with Real Data</h2>
		<p>Test the favorites system with actual design data from the JSON file.</p>
		<button class="btn-success" onclick="testWithRealData()">Test with Real Data</button>
		<div id="test-status"></div>
	</div>

	<div class="fix-section">
		<h2>Step 3: View Results</h2>
		<p>Check the favorites results after testing.</p>
		<button class="btn-primary" onclick="showResults()">Show Favorites Results</button>
		<div id="results-display"></div>
	</div>

	<div class="fix-section">
		<h2>Step 4: Go to Main App</h2>
		<p>Once everything looks good, go back to the main app to see your favorites.</p>
		<button class="btn-primary" onclick="goToMainApp()">Open Main App</button>
	</div>

	<script src="js/favorites-manager.js"></script>
	<script>
		function showStatus(elementId, message, type = 'success') {
			const element = document.getElementById(elementId);
			element.className = `status ${type}`;
			element.textContent = message;
		}

		function clearAllData() {
			try {
				if (typeof FavoritesManager !== 'undefined') {
					FavoritesManager.clearAllData();
					showStatus('clear-status', '‚úÖ All favorites data cleared successfully!');
				} else {
					throw new Error('FavoritesManager not available');
				}
			} catch (error) {
				showStatus('clear-status', '‚ùå Error clearing data: ' + error.message, 'error');
			}
		}

		async function testWithRealData() {
			try {
				showStatus('test-status', '‚è≥ Loading design data...');

				// Load real design data
				const response = await fetch('data/designs.json');
				const data = await response.json();
				const designs = data.designs;

				if (!designs || designs.length === 0) {
					throw new Error('No designs found in data file');
				}

				console.log('üìä Testing with real design data...');
				console.log('Sample design:', designs[0]);

				// Test with first 3 designs
				const testDesigns = designs.slice(0, 3);

				testDesigns.forEach((design, index) => {
					console.log(`üîç Processing design:`, {
						id: design.id,
						name: design.name,
						websiteUrl: design.websiteUrl
					});

					// Simulate different numbers of selections
					const selectionCount = index + 2; // 2, 3, 4 selections
					for (let i = 0; i < selectionCount; i++) {
						FavoritesManager.recordSelection(design.id, design);
					}

					// Heart the first design
					if (index === 0) {
						FavoritesManager.toggleHeart(design.id, design);
					}

					console.log(`‚úÖ Processed "${design.name}": ${selectionCount} selections${index === 0 ? ' + hearted' : ''}`);
				});

				showStatus('test-status', `‚úÖ Test completed! Processed ${testDesigns.length} designs. Check console for details.`);

			} catch (error) {
				console.error('‚ùå Error testing with real data:', error);
				showStatus('test-status', '‚ùå Error: ' + error.message, 'error');
			}
		}

		function showResults() {
			try {
				if (typeof FavoritesManager !== 'undefined') {
					const topFavorites = FavoritesManager.getTopFavorites();
					const stats = FavoritesManager.getStatistics();

					const resultsDiv = document.getElementById('results-display');

					let html = '<h3>üìä Statistics:</h3>';
					html += `<pre>${JSON.stringify(stats, null, 2)}</pre>`;

					html += '<h3>üèÜ Top Favorites:</h3>';
					if (topFavorites.length === 0) {
						html += '<p>No favorites found. Try running the test first.</p>';
					} else {
						html += '<pre>' + JSON.stringify(topFavorites, null, 2) + '</pre>';

						html += '<h3>üéØ Formatted Results:</h3>';
						html += '<div style="background: #f8f9fa; padding: 15px; border-radius: 4px;">';
						topFavorites.forEach((fav, index) => {
							html += `<div style="margin-bottom: 10px;">`;
							html += `<strong>${index + 1}) ${fav.title}</strong><br>`;
							html += `<a href="${fav.url}" target="_blank">${fav.url}</a><br>`;
							html += `<small>Selected ${fav.selectionCount} times${fav.isHearted ? ' ‚Ä¢ ‚ù§Ô∏è Bookmarked' : ''}</small>`;
							html += `</div>`;
						});
						html += '</div>';
					}

					resultsDiv.innerHTML = html;
				} else {
					throw new Error('FavoritesManager not available');
				}
			} catch (error) {
				document.getElementById('results-display').innerHTML =
					`<div class="status error">‚ùå Error: ${error.message}</div>`;
			}
		}

		function goToMainApp() {
			window.open('index.html', '_blank');
		}
	</script>
</body>

</html>