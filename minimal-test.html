<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Minimal Test</title>
	<style>
		body {
			font-family: system-ui;
			padding: 20px;
		}

		.log {
			margin: 5px 0;
			padding: 5px;
			border-radius: 3px;
		}

		.success {
			background: #d4edda;
		}

		.error {
			background: #f8d7da;
		}

		.info {
			background: #e3f2fd;
		}
	</style>
</head>

<body>
	<h1>Minimal Test</h1>
	<div id="log"></div>

	<script>
		function log(message, type = 'info') {
			const div = document.createElement('div');
			div.className = `log ${type}`;
			div.textContent = new Date().toLocaleTimeString() + ': ' + message;
			document.getElementById('log').appendChild(div);
			console.log(message);
		}

		// Test basic fetch first
		async function testBasicFetch() {
			try {
				log('Testing basic fetch...', 'info');
				const response = await fetch('data/sample-designs.json');
				if (!response.ok) {
					throw new Error(`HTTP ${response.status}`);
				}
				const data = await response.json();
				log(`âœ… Basic fetch successful - ${data.designs.length} designs`, 'success');
				return data;
			} catch (error) {
				log(`âŒ Basic fetch failed: ${error.message}`, 'error');
				throw error;
			}
		}

		// Load and test scripts
		function loadScript(src) {
			return new Promise((resolve, reject) => {
				const script = document.createElement('script');
				script.src = src;
				script.onload = resolve;
				script.onerror = reject;
				document.head.appendChild(script);
			});
		}

		async function runTests() {
			try {
				// Test basic fetch first
				await testBasicFetch();

				// Load scripts in order
				log('Loading data-validator.js...', 'info');
				await loadScript('js/data-validator.js?v=' + Date.now());
				log('âœ… data-validator.js loaded', 'success');

				log('Loading app-data-loader.js...', 'info');
				await loadScript('js/app-data-loader.js?v=' + Date.now());
				log('âœ… app-data-loader.js loaded', 'success');

				// Test DataValidator
				if (typeof DataValidator === 'undefined') {
					throw new Error('DataValidator not available');
				}
				log('âœ… DataValidator available', 'success');

				// Test AppDataLoader
				if (typeof AppDataLoader === 'undefined') {
					throw new Error('AppDataLoader not available');
				}
				log('âœ… AppDataLoader available', 'success');

				// Create instance
				const loader = new AppDataLoader();
				log('âœ… AppDataLoader instance created', 'success');

				// Check methods
				const methods = Object.getOwnPropertyNames(Object.getPrototypeOf(loader));
				log(`Available methods: ${methods.join(', ')}`, 'info');

				if (typeof loader.loadDesignsWithOfflineSupport !== 'function') {
					throw new Error('loadDesignsWithOfflineSupport method not found');
				}
				log('âœ… loadDesignsWithOfflineSupport method found', 'success');

				// Test loading
				log('Testing data loading...', 'i                const data = await loader.loadDesignsWithOfflineSupport('data / sample - designs.json', {
                    maxRetries: 1,
					onProgress: (info) => log(`ğŸ“Š ${info.message}`, 'info')
                });

			log(`âœ… Data loaded successfully - ${data.designs.length} designs`, 'success');
			log('ğŸ‰ All tests passed!', 'success');

		} catch (error) {
			log(`âŒ Test failed: ${error.message}`, 'error');
			console.error('Full error:', error);
		}
        }

		document.addEventListener('DOMContentLoaded', runTests);
	</script>
</body>

</html>